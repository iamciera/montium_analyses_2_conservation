 ---
title: "TFBS_visualization"
author: "Ciera Martinez"
date: "July 10, 2017"
output: pdf_document
---

**Purpose**: The purpose is to prototype 
1. what type of analysis I can do with the data set I have created. 
2. see what else in terms of information / data I need to collect.

### Set up 
```{r}
## Libraries
library(ggplot2)
library(dplyr)
library(stringr)


TFBS_df <- read.table("../data/outputs/map_motif_output/all.csv", sep = "\t", header = FALSE)

## Kvon data Info
## kvon <- read.csv("../outputData/dataframe/kvonMergedWithThomasStageSpecific_15November2016.csv", header=T, na.strings=c("","NA"))

## TFBS_df <- read.table("../data/outputs/map_motif_output/subsetTest/map_motif_testoutput_VT8890.fa-zelda_.fm.csv", sep = "\t", header = FALSE)

head(TFBS_df)
TFBS_df <- TFBS_df[,-1]

colnames(TFBS_df) <- c("position", "score",	"seq_len",	"species", "raw_position",	"strand",	"align_position",	"alignment_file", "motif_file")

dim(TFBS_df)

#remove NAs
## TFBS_df <- TFBS_df[complete.cases(TFBS_df), ]


## as.factor species

head(TFBS_df)
TFBS_df$species <- as.factor(TFBS_df$species)

speciesSplit  <- data.frame(do.call('rbind', strsplit(as.character(TFBS_df$species), split = "|", fixed = TRUE)))

head(speciesSplit)

TFBS_df <- TFBS_df[,-4]

TFBS_df <- cbind(TFBS_df, speciesSplit$X6)
colnames(TFBS_df)[9] <- "species"

TFBS_df$alignment_file <- gsub("output_", "", TFBS_df$alignment_file) 
TFBS_df$alignment_file <- gsub(".fa", "", TFBS_df$alignment_file)

head(TFBS_df)
str(TFBS_df)

summary(TFBS_df)
```

### Visualization

## To-Do

[ ] Need Phastcons score. 
[ ] Need to zoom in 
[ ] Build Shiny app
[ ] Finish the rest of the 
[ ] Attach positive and negative presence in insitu
[ ] 


motif_file != "eve_SOLEXA.fm", motif_file != "cad_FlyReg.fm",

```{r}
head(TFBS_df)
TFBS_df %>% filter(alignment_file =="VT8808", score > 6) %>% 
  ggplot(., aes(align_position,species, size = score, color = motif_file)) +
    geom_point(alpha = .3) + 
    facet_grid(strand~.) +
    theme_bw() +
    theme(text = element_text(size = 20)) 
```
?filter


